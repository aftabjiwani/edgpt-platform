<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EdGPT Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .pricing-card {
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .pricing-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .pricing-card.recommended {
            border-color: #667eea;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }
        .trial-status {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        .feature-list li:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-blue-600">EdGPT Dashboard</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-gray-600">Welcome, {{ signup[2] }}</span>
                    <a href="/logout" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Logout</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Trial Status -->
        <div class="trial-status">
            <div class="flex justify-between items-center">
                <div>
                    <h2 class="text-2xl font-bold mb-2">{{ signup[1] }} EdGPT</h2>
                    <p class="text-lg opacity-90">Your intelligent website assistant is active</p>
                </div>
                <div class="text-right">
                    <div class="text-3xl font-bold">FREE TRIAL</div>
                    <div class="text-sm opacity-90">
                        {% set trial_end = signup[14] %}
                        {% if trial_end %}
                            Ends: {{ trial_end.strftime('%B %d, %Y') if trial_end else 'N/A' }}
                        {% else %}
                            7-day trial active
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="grid md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white p-6 rounded-lg shadow-sm">
                <div class="text-2xl font-bold text-blue-600">24/7</div>
                <div class="text-gray-600">Always Available</div>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-sm">
                <div class="text-2xl font-bold text-green-600">95%</div>
                <div class="text-gray-600">Questions Answered</div>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-sm">
                <div class="text-2xl font-bold text-purple-600">3 sec</div>
                <div class="text-gray-600">Avg Response Time</div>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-sm">
                <div class="text-2xl font-bold text-orange-600">Active</div>
                <div class="text-gray-600">Current Status</div>
            </div>
        </div>

        <!-- Pricing Plans -->
        <div class="bg-white rounded-lg shadow-sm p-8 mb-8">
            <h3 class="text-2xl font-bold text-center mb-8">Choose Your Plan to Continue</h3>
            
            {% if domain == 'edgpt.ai' %}
            <!-- School Pricing -->
            <div class="grid md:grid-cols-3 gap-6">
                {% for plan in pricing_plans %}
                <div class="pricing-card bg-white rounded-lg shadow-sm p-6 {% if plan[2] == 'Medium School' %}recommended{% endif %}">
                    {% if plan[2] == 'Medium School' %}
                    <div class="bg-blue-600 text-white text-center py-2 px-4 rounded-full text-sm font-semibold mb-4">
                        MOST POPULAR
                    </div>
                    {% endif %}
                    
                    <h4 class="text-xl font-bold mb-2">{{ plan[2] }}</h4>
                    <div class="text-3xl font-bold text-blue-600 mb-2">${{ "%.0f"|format(plan[3]) }}</div>
                    <div class="text-gray-600 mb-4">per year</div>
                    <div class="text-sm text-gray-600 mb-6">{{ plan[6] }}</div>
                    
                    <ul class="feature-list text-sm text-gray-700 mb-6">
                        <li>✅ 24/7 AI receptionist</li>
                        <li>✅ Unlimited conversations</li>
                        <li>✅ Custom knowledge base</li>
                        <li>✅ Analytics dashboard</li>
                        <li>✅ Email support</li>
                        {% if plan[2] != 'Small School' %}
                        <li>✅ Priority support</li>
                        {% endif %}
                        {% if plan[2] == 'Large School' %}
                        <li>✅ Dedicated account manager</li>
                        <li>✅ Custom integrations</li>
                        {% endif %}
                    </ul>
                    
                    <div class="space-y-3">
                        <button onclick="selectPlan('{{ plan[0] }}', 'card')" 
                                class="w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition duration-200">
                            Pay with Credit Card
                        </button>
                        <button onclick="selectPlan('{{ plan[0] }}', 'invoice')" 
                                class="w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-200 transition duration-200">
                            Request Invoice
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <div class="mt-8 p-4 bg-blue-50 rounded-lg">
                <h4 class="font-semibold text-blue-900 mb-2">School Billing Information:</h4>
                <ul class="text-sm text-blue-800 space-y-1">
                    <li>• Annual billing aligned with school fiscal year (July 1 - June 30)</li>
                    <li>• Prorated billing based on signup date</li>
                    <li>• Invoice option available for purchase orders</li>
                    <li>• 30-day money-back guarantee</li>
                </ul>
            </div>
            
            {% else %}
            <!-- Business Pricing -->
            <div class="grid md:grid-cols-3 gap-6">
                {% for plan in pricing_plans %}
                <div class="pricing-card bg-white rounded-lg shadow-sm p-6 {% if plan[2] == 'Gold Plan' %}recommended{% endif %}">
                    {% if plan[2] == 'Gold Plan' %}
                    <div class="bg-blue-600 text-white text-center py-2 px-4 rounded-full text-sm font-semibold mb-4">
                        MOST POPULAR
                    </div>
                    {% endif %}
                    
                    <h4 class="text-xl font-bold mb-2">{{ plan[2] }}</h4>
                    <div class="text-3xl font-bold text-blue-600 mb-2">${{ "%.0f"|format(plan[3]) }}</div>
                    <div class="text-gray-600 mb-4">per month</div>
                    <div class="text-sm text-gray-600 mb-6">{{ plan[5] }}</div>
                    
                    <ul class="feature-list text-sm text-gray-700 mb-6">
                        <li>✅ 24/7 AI assistant</li>
                        <li>✅ Custom knowledge base</li>
                        <li>✅ Analytics dashboard</li>
                        <li>✅ Email support</li>
                        {% if plan[2] != 'Silver Plan' %}
                        <li>✅ Priority support</li>
                        <li>✅ Advanced analytics</li>
                        {% endif %}
                        {% if plan[2] == 'Platinum Plan' %}
                        <li>✅ Dedicated account manager</li>
                        <li>✅ Custom integrations</li>
                        <li>✅ White-label options</li>
                        {% endif %}
                    </ul>
                    
                    <button onclick="selectPlan('{{ plan[0] }}', 'card')" 
                            class="w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition duration-200">
                        Continue with This Plan
                    </button>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>

        <!-- Dashboard Features -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h3 class="text-lg font-semibold mb-4">💬 Message Center</h3>
                <p class="text-gray-600 mb-4">View and manage all conversations with your AI assistant.</p>
                <a href="/message-center/{{ signup_id }}" class="text-blue-600 hover:text-blue-700 font-medium">
                    View Messages →
                </a>
            </div>
            
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h3 class="text-lg font-semibold mb-4">📋 Forms Management</h3>
                <p class="text-gray-600 mb-4">Create and manage forms for data collection.</p>
                <a href="/forms-management/{{ signup_id }}" class="text-blue-600 hover:text-blue-700 font-medium">
                    Manage Forms →
                </a>
            </div>
            
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h3 class="text-lg font-semibold mb-4">📚 Knowledge Base</h3>
                <p class="text-gray-600 mb-4">Update and expand your AI's knowledge.</p>
                <a href="/knowledge-base/{{ signup_id }}" class="text-blue-600 hover:text-blue-700 font-medium">
                    Edit Knowledge →
                </a>
            </div>
            
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h3 class="text-lg font-semibold mb-4">📊 Analytics</h3>
                <p class="text-gray-600 mb-4">Track usage and performance metrics.</p>
                <a href="/analytics/{{ signup_id }}" class="text-blue-600 hover:text-blue-700 font-medium">
                    View Analytics →
                </a>
            </div>
            
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h3 class="text-lg font-semibold mb-4">⚙️ Settings</h3>
                <p class="text-gray-600 mb-4">Configure your AI assistant settings.</p>
                <a href="/settings/{{ signup_id }}" class="text-blue-600 hover:text-blue-700 font-medium">
                    Manage Settings →
                </a>
            </div>
            
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h3 class="text-lg font-semibold mb-4">🎯 Live Demo</h3>
                <p class="text-gray-600 mb-4">Test your AI assistant in real-time.</p>
                <a href="https://{{ domain }}" target="_blank" class="text-blue-600 hover:text-blue-700 font-medium">
                    View Live Site →
                </a>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
            <h3 class="text-xl font-bold mb-4">Continue Your EdGPT</h3>
            <div id="modalContent"></div>
            <div class="flex justify-end space-x-4 mt-6">
                <button onclick="closeModal()" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancel</button>
                <button id="confirmButton" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Confirm</button>
            </div>
        </div>
    </div>

    <script>
        function selectPlan(planId, paymentType) {
            const modal = document.getElementById('paymentModal');
            const modalContent = document.getElementById('modalContent');
            const confirmButton = document.getElementById('confirmButton');
            
            if (paymentType === 'card') {
                modalContent.innerHTML = `
                    <p class="text-gray-700 mb-4">You'll be redirected to our secure payment processor to complete your subscription.</p>
                    <div class="bg-green-50 p-4 rounded-lg">
                        <p class="text-green-800 text-sm">✅ Secure payment processing</p>
                        <p class="text-green-800 text-sm">✅ Instant activation</p>
                        <p class="text-green-800 text-sm">✅ 30-day money-back guarantee</p>
                    </div>
                `;
                confirmButton.textContent = 'Continue to Payment';
                confirmButton.onclick = () => {
                    // Redirect to Stripe payment link
                    window.location.href = `/payment/stripe/${planId}`;
                };
            } else {
                modalContent.innerHTML = `
                    <p class="text-gray-700 mb-4">We'll generate an invoice for your school's accounting department.</p>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <p class="text-blue-800 text-sm">📄 Professional invoice generated</p>
                        <p class="text-blue-800 text-sm">💼 Perfect for purchase orders</p>
                        <p class="text-blue-800 text-sm">📧 Sent to your email within 24 hours</p>
                    </div>
                `;
                confirmButton.textContent = 'Request Invoice';
                confirmButton.onclick = () => {
                    // Redirect to invoice request
                    window.location.href = `/invoice/request/${planId}`;
                };
            }
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }
        
        function closeModal() {
            const modal = document.getElementById('paymentModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }
        
        // Close modal on outside click
        document.getElementById('paymentModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>

